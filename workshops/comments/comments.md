# Comments
Comments are messages generated by Box users on files, allowing users to collaborate together on a file, discussing any feedback they might have on the content.

Each comment is tied to a specific file and user, and comments can be created as independent comments or as replies to previous comments.


## Concepts

## Files API
References to our documentation:
* [SDK](https://github.com/box/box-python-sdk/blob/main/docs/usage/comments.md)
* [API Guide](https://developer.box.com/guides/comments/create-comment/)
* [API Reference](https://developer.box.com/reference/resources/comment/)


# Exercises
## Setup
Create a `comments_init.py` file on the root of the project and execute the following code:
```python
"""create sample content to box"""
import logging
from utils.config import AppConfig

from utils.box_client import get_client

from workshops.comments.create_samples import create_samples

logging.basicConfig(level=logging.INFO)
logging.getLogger("boxsdk").setLevel(logging.CRITICAL)

conf = AppConfig()


if __name__ == "__main__":
    client = get_client(conf)
    create_samples(client)

```
Result:
```
INFO:root:Folder workshops with id: 223095001439
INFO:root:Folder comments with id: 223269791429
INFO:root:      Uploaded sample_file.txt
```
Now open your Box.com app, and enter some comments on the `sample_file.txt` file, under `ALL Files > workshops > comments` folder, and take note of the `file_id` in the URL.
For examples:
![Alt text](/images/comments_file.png)

Next, create a `comments.py` file on the root of the project that you will use to write your code.
Create a global constant named `COMMENTS_ROOT` and make it equal to the id of the `comments` folder, in my case `223269791429`
Create a global constant named `SAMPLE_FILE` and make it equal to the id of the `sample_file.txt` file, in my case `1290064263703`

```python
"""Box File Comments"""

import logging

from boxsdk import Client
from boxsdk.object.file import File

from utils.config import AppConfig
from utils.box_client import get_client

logging.basicConfig(level=logging.INFO)
logging.getLogger("boxsdk").setLevel(logging.CRITICAL)

conf = AppConfig()

COMMENTS_ROOT = "223269791429"
SAMPLE_FILE = "1290064263703"


def print_file_comments(client: Client, file: File):
    """Print all comments for a file"""
    comments = file.get_comments()
    print(f"\nComments for file {file.name} ({file.id}):")
    for comment in comments:
        print("-" * 80)
        print(f"{comment.message} by {comment.created_by.name} ({comment.created_at})")
    print("-" * 80)


def main():
    """Simple script to demonstrate how to use the Box SDK"""
    client = get_client(conf)

    user = client.user().get()
    print(f"\nHello, I'm {user.name} ({user.login}) [{user.id}]")

    file = client.file(SAMPLE_FILE).get()

    # print file comments
    print_file_comments(client, file)


if __name__ == "__main__":
    main()
```


## List file comments
Create a method to list all the comments on a file object.
```python
def file_comments_print(client: Client, file: File):
    """Print all comments for a file"""
    comments = file.get_comments()
    print(f"\nComments for file {file.name} ({file.id}):")
    for comment in comments:
        print("-" * 10)
        print(f"{comment.message} by {comment.created_by.name} ({comment.created_at})")
    print("-" * 10)
```
Then use it in your main method:
```python
def main():
    ...

     # print file comments
    file_comments_print(client, file)
```
Resulting in:
```
Comments for file sample_file.txt (1290064263703):
----------
This is a comment by Free Dev 001 (2023-08-25T11:51:39-07:00)
----------
```
## Add a comment to a file
Create a method to add a comment to a file.
```python
def file_comment_add(client: Client, file: File, message: str) -> Comment:
    """Add a comment to a file"""
    return file.add_comment(message)
```
And then add it to the main method:
```python
def main():
    ...

    # add another comment
    comment = file_comment_add(client, file, "What is this file about?")
    file_comments_print(client, file)
```
Resulting in:
```
Comments for file sample_file.txt (1290064263703):
----------
This is a comment by Free Dev 001 (2023-08-25T11:51:39-07:00)
----------
What is this file about? by Free Dev 001 (2023-08-25T12:18:25-07:00)
----------
```
## Reply to a comment
You can also specifically reply to a comment. Let's create a reply method:
```python
def file_comment_reply(client: Client, comment: Comment, message: str) -> Comment:
    """Reply to a comment"""
    return comment.reply(message)
```
and add it to the main method:
```python
def main():
    ...

    # reply to the last comment
    comment_reply = file_comment_reply(client, comment, "I hear you!!! This is a sample file")
    file_comments_print(client, file)
```

## Deleting comments
You can also delete comments, let's create a method for that:
```python
def file_comment_delete(client: Client, comment: Comment):
    """Delete a comment"""
    try:
        comment.delete()
    except BoxAPIException as err:
        if err.status != 404:
            raise err
```
The exception is to handle the case where the comment was already deleted.
This may happen when we delete a comment which also deletes all the replies, and then try to delte the reply again.
In your main method, delete all comments for the file:
```python
def main():
    ...

    # delete all comments
    file_comment_delete(client, comment_reply)
    comments = file.get_comments()
    for comment in comments:
        file_comment_delete(client, comment)
    file_comments_print(client, file)
```

## Extra Credit
There are a few more things you can do with comments:
* Create a method to Edit a comment
* Create a methos that serializes a comment to JSON
* Improve the print method to print the replies to a comment idented


# Final thoughts










